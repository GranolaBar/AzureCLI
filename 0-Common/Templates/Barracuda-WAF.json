{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    
    "parameters": {
        "virtualMachines_WAF1_name":          { "type": "string",       "defaultValue": "WAF1",           "metadata": { "description": "Azure WAF1 Server Name"                                 } },
        "virtualMachines_WAF1_adminPassword": { "type": "securestring", "defaultValue": null,             "metadata": { "description": "Admin Password for WAF Web Console"                     } },
        "networkInterfaces_waf1215_name":     { "type": "string",       "defaultValue": "waf1215",        "metadata": { "description": "Network Interface Card for WAF1"                        } },
        "publicIPAddresses_WAF1_name":        { "type": "string",       "defaultValue": "WAF1",           "metadata": { "description": "Azure Public IP for WAF1"                               } },
                       
        "virtualMachines_WAF2_name":          { "type": "string",       "defaultValue": "WAF2",           "metadata": { "description": "Azure WAF2 Server Name"                                 } },
        "virtualMachines_WAF2_adminPassword": { "type": "securestring", "defaultValue": null,             "metadata": { "description": "Admin Password for WAF Web Console"                     } },
        "networkInterfaces_waf2465_name":     { "type": "string",       "defaultValue": "waf2465",        "metadata": { "description": "Network Interface Card for WAF2"                        } },
        "publicIPAddresses_WAF2_name":        { "type": "string",       "defaultValue": "WAF2",           "metadata": { "description": "Azure Public IP for WAF2"                               } },
        
        
        "virtualNetworks_NVA_name":           { "type": "string",       "defaultValue": "WAFVnet",        "metadata": { "description": "Azure Virtual Network Name"                             } },
        "availabilitySets_NVA_AS_name":       { "type": "string",       "defaultValue": "NVA-AS",         "metadata": { "description": "Azure Availablity Set Name"                             } },
        "storageAccounts_aaronlvdc1361_name": { "type": "string",       "defaultValue": "aaronlvdc1361",  "metadata": { "description": "WAF Storage Account Name. Must be all lower case"       } },
        "resouceLocation":                    { "type": "string",       "defaultValue": "centralus",      "metadata": {"description": "Azure resource location"                                 } } 
     },
  
    "variables": {  
     },
    
    "resources": [
    
    {
            "comments": "Generalized from resource: '/subscriptions/d520400f-6874-43f2-9ed9-3850af521c18/resourceGroups/AaronLVDC/providers/Microsoft.Compute/availabilitySets/NVA-AS'.",
            "type": "Microsoft.Compute/availabilitySets",
            "name": "[parameters('availabilitySets_NVA_AS_name')]",
            "apiVersion": "2015-06-15",
            "location": "[parameters('resouceLocation')]",
      
            "properties": {
                "platformUpdateDomainCount": 5,
                "platformFaultDomainCount": 3     },
                "dependsOn": [ ]
    },
    {
            "comments": "Generalized from resource: '/subscriptions/d520400f-6874-43f2-9ed9-3850af521c18/resourceGroups/AaronLVDC/providers/Microsoft.Compute/virtualMachines/WAF1'.",
            "type": "Microsoft.Compute/virtualMachines",
            "name": "[parameters('virtualMachines_WAF1_name')]",
            "apiVersion": "2015-06-15",
            "location": "[parameters('resouceLocation')]",
            "plan": {
                "name": "hourly",
                "product": "waf",
                "publisher": "barracudanetworks"
      },
            "properties": {
                "availabilitySet": {
                "id": "[resourceId('Microsoft.Compute/availabilitySets', parameters('availabilitySets_NVA_AS_name'))]"
      },
            "hardwareProfile": {
                "vmSize": "Standard_A2"
        },
            "storageProfile": {
                "imageReference": {
                "publisher": "barracudanetworks",
                "offer": "waf",
                "sku": "hourly",
                "version": "latest"
          },
            "osDisk": {
                "name": "[parameters('virtualMachines_WAF1_name')]",
                "createOption": "FromImage",
                "vhd": {
                "uri": "[concat('https', '://', parameters('storageAccounts_aaronlvdc1361_name'), '.blob.core.windows.net', concat('/vhds/', parameters('virtualMachines_WAF1_name'),'201652382930.vhd'))]"
            },
                "caching": "ReadWrite"
          },
                "dataDisks": [ ]
        },
            "osProfile": {
                "computerName": "[parameters('virtualMachines_WAF1_name')]",
                "adminUsername": "wafadmin",
                "linuxConfiguration": {
                "disablePasswordAuthentication": false
          },
            "secrets": [ ],
                "adminPassword": "[parameters('virtualMachines_WAF1_adminPassword')]"
        },
            "networkProfile": {
            "networkInterfaces": [
            {
                "id": "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_waf1215_name'))]"
            }
          ]
        }
      },
            "dependsOn": [
               "[resourceId('Microsoft.Compute/availabilitySets', parameters('availabilitySets_NVA_AS_name'))]",
               "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccounts_aaronlvdc1361_name'))]",
               "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_waf1215_name'))]"
      ]
    },
    {
            "comments": "Generalized from resource: '/subscriptions/d520400f-6874-43f2-9ed9-3850af521c18/resourceGroups/AaronLVDC/providers/Microsoft.Compute/virtualMachines/WAF2'.",
            "type": "Microsoft.Compute/virtualMachines",
            "name": "[parameters('virtualMachines_WAF2_name')]",
            "apiVersion": "2015-06-15",
            "location": "[parameters('resouceLocation')]",
            "plan": {
                "name": "hourly",
                "product": "waf",
                "publisher": "barracudanetworks"
      },
            "properties": {
                "availabilitySet": {
                "id": "[resourceId('Microsoft.Compute/availabilitySets', parameters('availabilitySets_NVA_AS_name'))]"
        },
            "hardwareProfile": {
                "vmSize": "Standard_A2"
        },
            "storageProfile": {
                "imageReference": {
                "publisher": "barracudanetworks",
                "offer": "waf",
                "sku": "hourly",
                "version": "latest"
          },
            "osDisk": {
                "name": "[parameters('virtualMachines_WAF2_name')]",
                "createOption": "FromImage",
                "vhd": {
                "uri": "[concat('https', '://', parameters('storageAccounts_aaronlvdc1361_name'), '.blob.core.windows.net', concat('/vhds/', parameters('virtualMachines_WAF2_name'),'201652391648.vhd'))]"
            },
            "caching": "ReadWrite"
          },
            "dataDisks": [ ]
        },
            "osProfile": {
                "computerName": "[parameters('virtualMachines_WAF2_name')]",
                "adminUsername": "wafadmin",
                "linuxConfiguration": {
                "disablePasswordAuthentication": false
          },
            "secrets": [ ],
            "adminPassword": "[parameters('virtualMachines_WAF2_adminPassword')]"
        },
            "networkProfile": {
            "networkInterfaces": [
            {
                "id": "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_waf2465_name'))]"
            }
          ]
        }
      },
            "dependsOn": [
                "[resourceId('Microsoft.Compute/availabilitySets', parameters('availabilitySets_NVA_AS_name'))]",
                "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccounts_aaronlvdc1361_name'))]",
                "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_waf2465_name'))]"
      ]
    },
    {
            "comments": "Generalized from resource: '/subscriptions/d520400f-6874-43f2-9ed9-3850af521c18/resourceGroups/AaronLVDC/providers/Microsoft.Network/networkInterfaces/waf1215'.",
            "type": "Microsoft.Network/networkInterfaces",
            "name": "[parameters('networkInterfaces_waf1215_name')]",
            "apiVersion": "2016-03-30",
            "location": "[parameters('resouceLocation')]",
            "properties": {
            "ipConfigurations": [
          {
            "name": "ipconfig1",
            "properties": {
                "privateIPAddress": "10.4.1.4",
                "privateIPAllocationMethod": "Dynamic",
                "publicIPAddress": {
                    "id": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_WAF1_name'))]"
              },
                "subnet": {
                    "id": "[concat(resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_NVA_name')), '/subnets/FrontEnd')]"
              }
            }
          }
        ],
                "dnsSettings": {
                    "dnsServers": [ ]
        },
                "enableIPForwarding": false
      },
            "dependsOn": [
                "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_WAF1_name'))]",
                "[resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_NVA_name'))]"
      ]
    },
    {
            "comments": "Generalized from resource: '/subscriptions/d520400f-6874-43f2-9ed9-3850af521c18/resourceGroups/AaronLVDC/providers/Microsoft.Network/networkInterfaces/waf2465'.",
            "type": "Microsoft.Network/networkInterfaces",
            "name": "[parameters('networkInterfaces_waf2465_name')]",
            "apiVersion": "2016-03-30",
            "location": "[parameters('resouceLocation')]",
            "properties": {
                "ipConfigurations": [
          {
                "name": "ipconfig1",
            "properties": {
                "privateIPAddress": "10.4.1.5",
                "privateIPAllocationMethod": "Dynamic",
                "publicIPAddress": {
                "id": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_WAF2_name'))]"
              },
                "subnet": {
                    "id": "[concat(resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_NVA_name')), '/subnets/FrontEnd')]"
              }
            }
          }
        ],
                "dnsSettings": {
                "dnsServers": [ ]
        },
                "enableIPForwarding": false
      },
            "dependsOn": [
                "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_WAF2_name'))]",
                "[resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_NVA_name'))]"
      ]
    },
    {
            "comments": "Generalized from resource: '/subscriptions/d520400f-6874-43f2-9ed9-3850af521c18/resourceGroups/AaronLVDC/providers/Microsoft.Network/publicIPAddresses/WAF1'.",
            "type": "Microsoft.Network/publicIPAddresses",
            "name": "[parameters('publicIPAddresses_WAF1_name')]",
            "apiVersion": "2016-03-30",
            "location": "[parameters('resouceLocation')]",
            "properties": {
                "publicIPAllocationMethod": "Dynamic",
                "idleTimeoutInMinutes": 4,
                "dnsSettings": {
                "domainNameLabel": "petstore"
        }
      },
            "dependsOn": [ ]
    },
    {
            "comments": "Generalized from resource: '/subscriptions/d520400f-6874-43f2-9ed9-3850af521c18/resourceGroups/AaronLVDC/providers/Microsoft.Network/publicIPAddresses/WAF2'.",
            "type": "Microsoft.Network/publicIPAddresses",
            "name": "[parameters('publicIPAddresses_WAF2_name')]",
            "apiVersion": "2016-03-30",
            "location": "[parameters('resouceLocation')]",
      
            "properties": {
                "publicIPAllocationMethod": "Dynamic",
                "idleTimeoutInMinutes": 4
      },
                "dependsOn": [ ]
    },
    {
            "comments": "Generalized from resource: '/subscriptions/d520400f-6874-43f2-9ed9-3850af521c18/resourceGroups/AaronLVDC/providers/Microsoft.Network/virtualNetworks/NVA'.",
            "type": "Microsoft.Network/virtualNetworks",
            "name": "[parameters('virtualNetworks_NVA_name')]",
            "apiVersion": "2016-03-30",
            "location": "[parameters('resouceLocation')]",
           
            "properties": {
                "addressSpace": {
                "addressPrefixes": [
                "10.4.0.0/16"
          ]
        },
                "subnets": [
          {
                "name": "FrontEnd",
            
            "properties": {
                "addressPrefix": "10.4.1.0/24"
            }
          },
          {
            "name": "BackEnd",
            
            "properties": {
                "addressPrefix": "10.4.2.0/24"
            }
          },
          {
            "name": "AppServiceA",
            "properties": {
                "addressPrefix": "10.4.3.0/24"
            }
          },
          {
            "name": "AppServiceB",
            "properties": {
                "addressPrefix": "10.4.4.0/24"
            }
          }
        ]
      },
            "dependsOn": [ ]
    },
    {
            "comments": "Generalized from resource: '/subscriptions/d520400f-6874-43f2-9ed9-3850af521c18/resourceGroups/aaronlvdc/providers/Microsoft.Storage/storageAccounts/aaronlvdc1361'.",
            "type": "Microsoft.Storage/storageAccounts",
            "sku": {
            "name": "Standard_LRS",
            "tier": "Standard"
      },
            "kind": "Storage",
            "name": "[parameters('storageAccounts_aaronlvdc1361_name')]",
            "apiVersion": "2016-01-01",
            "location": "[parameters('resouceLocation')]",
            "tags": { },
           "properties": { },
           "dependsOn": [ ]
    }
  ]
}